(this.webpackJsonpreactjs_ecommerce=this.webpackJsonpreactjs_ecommerce||[]).push([[0],{62:function(e,t,c){},63:function(e,t,c){},64:function(e,t,c){},65:function(e,t,c){},71:function(e,t,c){},72:function(e,t,c){},73:function(e,t,c){},79:function(e,t,c){"use strict";c.r(t);var n=c(3),a=c(2),r=c.n(a),i=c(27),s=c.n(i),o=(c(62),c(63),c(54)),j=(c(64),c(65),c(82)),l=c(55),d=c(17),u=Object(a.createContext)(),b=function(e){var t=Object(a.useState)([]),c=Object(d.a)(t,2),r=c[0],i=c[1],s=function(e){return r.some((function(t){return t.id===e}))};return Object(n.jsx)(u.Provider,{value:{products:r,addProduct:function(e,t){e.quantity=parseInt(t),s(e.id)?i(r.map((function(t){return t.id===e.id?e:t}))):i([].concat(Object(l.a)(r),[e]))},removeProduct:function(e){i(r.filter((function(t){return t.id!==e})))},clear:function(){i([])},getQuantity:function(){var e=0;return r.map((function(t){return e+=t.quantity})),e},getTotal:function(){var e=0;return r.map((function(t){return e+=t.price*t.quantity})),e}},children:e.children})},O=function(){var e=Object(a.useContext)(u);return Object(n.jsxs)("div",{children:[Object(n.jsx)(j.a,{className:"product-cart",id:"cart-icon",size:"32"}),Object(n.jsx)("span",{className:"badge badge-warning",id:"cart-label-count",children:e.getQuantity()})]})},h=c(14),m=function(){var e=Object(a.useContext)(u);return Object(n.jsxs)(o.a,{children:[Object(n.jsx)(h.c,{to:"/",children:"FilVAR"}),Object(n.jsxs)("div",{className:"categories",children:[Object(n.jsx)(h.c,{exact:!0,to:"/",activeClassName:"route-active",children:Object(n.jsx)("p",{className:"menu-item",children:"Catalogo"})}),Object(n.jsx)(h.c,{to:"/category/1",activeClassName:"route-active",children:Object(n.jsx)("p",{className:"menu-item",children:"Aire"})}),Object(n.jsx)(h.c,{to:"/category/2",activeClassName:"route-active",children:Object(n.jsx)("p",{className:"menu-item",children:"Aceite"})}),Object(n.jsx)(h.c,{to:"/category/3",activeClassName:"route-active",children:Object(n.jsx)("p",{className:"menu-item",children:"Combustible"})}),Object(n.jsx)(h.c,{to:"/category/4",activeClassName:"route-active",children:Object(n.jsx)("p",{className:"menu-item",children:"Habit\xe1culo"})}),e.products.length>0&&Object(n.jsx)(h.b,{to:"/cart",children:Object(n.jsx)(O,{})})]})]})},x=(c(70),c(24)),f=c(13),p=c(45),g=(c(71),function(e){var t=e.item;return Object(n.jsx)(f.a,{className:"col-sm-3 text-center item mb-4",children:Object(n.jsx)(h.b,{to:"/item/".concat(t.id),children:Object(n.jsx)(p.a,{children:Object(n.jsxs)(p.a.Body,{children:[Object(n.jsx)("h4",{children:t.title}),Object(n.jsx)("img",{src:t.pictureUrl,alt:t.description,className:"img-fluid mb-2"}),Object(n.jsxs)("h5",{children:["$ ",t.price]})]})})})})}),v=c(19),C=function(e){var t=e.items;return Object(n.jsx)(v.a,{children:t.map((function(e){return Object(n.jsx)(g,{item:e},e.id.toString())}))})},N=c(12),y=c(29),k=c(42),I=(c(48),"reactjsecommerce-84729"),S={apiKey:"AIzaSyBqYr9lECFmRZTDeiyUKlfOyZyDRZ-NGmk",authDomain:"reactjsecommerce-84729.firebaseapp.com",projectId:I,storageBucket:"reactjsecommerce-84729.appspot.com",messagingSenderId:"59653033430",appId:"1:59653033430:web:be039c0dcc5301ae366877",measurementId:"G-4C3P9LSNSZ"};console.log("PROJECTID:"+I);var P=k.a.initializeApp(S);function E(){return k.a.firestore(P)}var T=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),c=t[0],r=t[1],i=Object(N.g)().idCategory;return Object(a.useEffect)((function(){var e=E().collection("products"),t=e;i>0&&(t=e.where("idCategory","==",i)),t.get().then((function(e){0===e.size?r([]):r(e.docs.map((function(e){return Object(x.a)(Object(x.a)({},e.data()),{},{id:e.id})})))})).catch((function(e){console.log("error al recuperar los productos"),console.log(e)})).finally()}),[i]),Object(n.jsx)(y.a,{children:Object(n.jsx)(C,{items:c})})};c(72),c(73);function D(e){var t=e.stock,c=e.initial,r=e.onChange,i=Object(a.useState)(Number(c)),s=Object(d.a)(i,2),o=s[0],j=s[1];Object(a.useEffect)((function(){r(o)}),[o]);return Object(n.jsx)("div",{className:"itemCount",children:Object(n.jsxs)("div",{className:"qty",children:[Object(n.jsx)("a",{href:"#",className:"action minus bg-dark",onClick:function(){j(o>c?o-1:0)},children:"-"}),Object(n.jsx)("div",{className:"count",name:"qty",children:o}),Object(n.jsx)("a",{href:"#",className:"action plus bg-dark",onClick:function(){j(o<t?o+1:t)},children:"+"})]})})}var q=c(46),w=function(e){var t=e.item,c=Object(N.f)(),r=Object(a.useState)(0),i=Object(d.a)(r,2),s=i[0],o=i[1],j=Object(a.useState)(!1),l=Object(d.a)(j,2),b=l[0],O=l[1],h=Object(a.useState)("sin stock"),m=Object(d.a)(h,2),x=m[0],p=m[1],g=Object(a.useContext)(u);return Object(a.useEffect)((function(){O(s>0)}),[s]),Object(a.useEffect)((function(){p(t.stock>0?1==t.stock?"\xdaltima disponible!":"".concat(t.stock," disponibles"):"sin stock")}),[t]),Object(n.jsxs)(y.a,{className:"item-detail",children:[Object(n.jsxs)(v.a,{children:[Object(n.jsx)(f.a,{xs:9,children:Object(n.jsx)("div",{className:"text-center",children:Object(n.jsx)("img",{src:t.image,alt:t.description,className:"img-fluid big-image"})})}),Object(n.jsxs)(f.a,{xs:3,className:"detail",children:[Object(n.jsx)("h5",{children:t.title}),Object(n.jsxs)("div",{className:"price",children:["$",t.price]}),Object(n.jsx)("div",{className:"stock",children:x}),Object(n.jsx)(v.a,{children:Object(n.jsx)(f.a,{className:"mt-2",children:t&&Object(n.jsx)(D,{onChange:function(e){o(e)},initial:"0",stock:t.stock})})}),Object(n.jsx)(v.a,{children:Object(n.jsx)(f.a,{className:"mt-4",children:b&&Object(n.jsx)(q.a,{onClick:function(){g.addProduct(t,s),c.push("/cart")},variant:"success",block:!0,children:"Comprar Ahora"})})}),Object(n.jsx)(v.a,{children:Object(n.jsx)(f.a,{className:"mt-2",children:b&&Object(n.jsx)(q.a,{onClick:function(){g.addProduct(t,s)},variant:"secondary",block:!0,children:"Agregar al carrito"})})})]})]}),Object(n.jsx)(v.a,{children:Object(n.jsxs)(f.a,{className:"mt-1",children:[Object(n.jsx)("h3",{children:"Descripci\xf3n"}),t.description]})})]})},F=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),c=t[0],r=t[1],i=Object(N.g)().idProduct;return Object(a.useEffect)((function(){null!=i&&E().collection("products").doc(i).get().then((function(e){r(Object(x.a)(Object(x.a)({},e.data()),{},{id:e.id}))})).catch((function(e){console.log("error al recuperar los productos")})).finally()}),[i]),Object(n.jsx)(v.a,{children:Object(n.jsx)(w,{item:c})})},A=c(43),L=c.n(A),G=c(53),R=c(33),B=c(84),z=c(83),V=c(44),Z=function(){Object(N.f)();var e=Object(a.useContext)(u),t=Object(a.useState)(""),c=Object(d.a)(t,2),i=c[0],s=c[1],o=Object(a.useState)({name:"",phone:"",email:"",emailVerification:""}),j=Object(d.a)(o,2),l=j[0],b=j[1],O=Object(a.useState)(!1),m=Object(d.a)(O,2),p=m[0],g=m[1];Object(a.useEffect)((function(){g(!Object.values(l).some((function(e){return""===e}))&&l.email===l.emailVerification)}),[l]);var C=function(e){b(Object(x.a)(Object(x.a)({},l),{},Object(R.a)({},e.target.id,e.target.value)))},k=function(){var t=Object(G.a)(L.a.mark((function t(c){var n,a,r,i,s;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.products.map((function(e){return e.id})),a=c.collection("products").where(V.a.firestore.FieldPath.documentId(),"in",n),t.next=4,a.get();case 4:r=t.sent,i=c.batch(),s=[],r.docs.forEach((function(t,c){t.data().stock>=e.products[c].quantity?i.update(t.ref,{stock:t.data().stock-e.products[c].quantity}):s.push(Object(x.a)(Object(x.a)({},t.data()),{},{id:t.id}))})),i.commit();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(n.jsx)(y.a,{children:Object(n.jsx)(v.a,{children:Object(n.jsxs)(f.a,{children:[Object(n.jsx)("h1",{children:"Detalle del pedido"}),Object(n.jsx)(y.a,{children:Object(n.jsx)(v.a,{children:0===e.products.length?Object(n.jsxs)(f.a,{className:"empty-cart",children:[Object(n.jsx)("h2",{children:"No hay productos."}),i&&Object(n.jsx)(v.a,{children:Object(n.jsxs)(f.a,{className:"text-center",children:["Perfecto! ",Object(n.jsx)("br",{}),"Tu orden generada es: ",i]})}),Object(n.jsx)(h.b,{to:"/",children:Object(n.jsx)(q.a,{variant:"primary",children:"Home"})})]}):Object(n.jsxs)(r.a.Fragment,{children:[Object(n.jsx)(f.a,{children:Object(n.jsxs)(B.a,{children:[e.products.map((function(t){return Object(n.jsx)(B.a.Item,{children:Object(n.jsxs)(v.a,{className:"align-items-center",children:[Object(n.jsxs)(f.a,{xs:3,className:"text-center",children:[Object(n.jsx)(q.a,{variant:"danger",onClick:function(){return e.removeProduct(t.id)},children:"Eliminar"}),Object(n.jsx)("br",{}),Object(n.jsxs)("i",{children:[t.quantity," unidades"]})]}),Object(n.jsx)(f.a,{xs:4,className:"text-center",children:Object(n.jsx)("img",{src:t.pictureUrl,alt:t.title})}),Object(n.jsx)(f.a,{children:Object(n.jsxs)("div",{children:[Object(n.jsx)("h5",{children:t.title}),Object(n.jsxs)("h4",{children:["$",t.price]})]})})]})},t.id)})),Object(n.jsxs)("h4",{children:["Cantidad: ",e.getQuantity()]}),Object(n.jsxs)("h4",{children:["Total: $",e.getTotal()]})]})}),Object(n.jsxs)(f.a,{children:[Object(n.jsx)("h2",{children:"Datos del comprador"}),Object(n.jsxs)(z.a,{children:[Object(n.jsxs)(z.a.Group,{controlId:"name",children:[Object(n.jsx)(z.a.Label,{children:"Nombre"}),Object(n.jsx)(z.a.Control,{placeholder:"Ingrese su nombre",onChange:C})]}),Object(n.jsxs)(z.a.Group,{controlId:"phone",children:[Object(n.jsx)(z.a.Label,{children:"Tel\xe9fono"}),Object(n.jsx)(z.a.Control,{placeholder:"Ingrese su tel\xe9fono",onChange:C})]}),Object(n.jsxs)(z.a.Group,{controlId:"email",children:[Object(n.jsx)(z.a.Label,{children:"Email"}),Object(n.jsx)(z.a.Control,{type:"email",placeholder:"Ingrese su email",onChange:C})]}),Object(n.jsxs)(z.a.Group,{controlId:"emailVerification",children:[Object(n.jsx)(z.a.Label,{children:"Repetir Email"}),Object(n.jsx)(z.a.Control,{type:"email",placeholder:"Repita su email",onChange:C})]}),Object(n.jsx)(q.a,{disabled:!p,variant:"success",onClick:function(){var t=E(),c=t.collection("orders"),n={buyer:l,items:e.products,date:V.a.firestore.Timestamp.fromDate(new Date),total:e.getTotal()};c.add(n).then((function(c){var n=c.id;s(n),k(t),e.clear()})).catch((function(e){return console.log("ocurrio un error")})).finally((function(){return console.log("termino el proceso")}))},children:"Confirmar Compra"})]})]})]})})})]})})})};var $=function(){return Object(n.jsx)(h.a,{children:Object(n.jsxs)(b,{children:[Object(n.jsx)(m,{}),Object(n.jsxs)(N.c,{children:[Object(n.jsx)(N.a,{path:"/cart",children:Object(n.jsx)(Z,{})}),Object(n.jsx)(N.a,{path:"/item/:idProduct",children:Object(n.jsx)(F,{})}),Object(n.jsx)(N.a,{path:"/category/:idCategory",children:Object(n.jsx)(T,{})}),Object(n.jsx)(N.a,{path:"/",children:Object(n.jsx)(T,{})})]})]})})},J=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,85)).then((function(t){var c=t.getCLS,n=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;c(e),n(e),a(e),r(e),i(e)}))};s.a.render(Object(n.jsx)(r.a.StrictMode,{children:Object(n.jsx)($,{})}),document.getElementById("root")),J()}},[[79,1,2]]]);
//# sourceMappingURL=main.17887e92.chunk.js.map